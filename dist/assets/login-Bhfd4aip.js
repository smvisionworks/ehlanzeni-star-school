import{a as f,d as i}from"./firebase-B3bAttLw.js";import{signInWithEmailAndPassword as g}from"https://www.gstatic.com/firebasejs/10.12.0/firebase-auth.js";import{ref as r,get as d}from"https://www.gstatic.com/firebasejs/10.12.0/firebase-database.js";import"https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js";import"https://www.gstatic.com/firebasejs/10.12.0/firebase-storage.js";document.getElementById("login-form").addEventListener("submit",async o=>{o.preventDefault();const e=o.target.querySelector('button[type="submit"]');e.disabled=!0,e.textContent="Logging in...";try{const t=document.getElementById("login-email").value,n=document.getElementById("login-password").value,s=(await g(f,t,n)).user,p=r(i,`teachers/${s.uid}`);if((await d(p)).exists()){console.log("Teacher login - redirecting to teacher dashboard"),window.location.href="../teachers/teacherdashboard.html";return}const u=r(i,`application/pending/${s.uid}`),c=await d(u);if(c.exists()){const a=c.val();console.log("Application data found:",a),a.status==="approved"&&a.payment&&a.payment.registrationFee==="paid"?(console.log("Application complete - redirecting to verified dashboard"),window.location.href="../students/studentdashboard.html"):(console.log("Application incomplete - redirecting to unverified dashboard"),window.location.href="../unverifiedstudents/student-dashboard.html");return}const m=r(i,`application/approved/${s.uid}`);if((await d(m)).exists()){console.log("Legacy approved user - redirecting to verified dashboard"),window.location.href="../students/studentdashboard.html";return}console.log("No application found for user"),l("No application found for this account.","error"),e.disabled=!1,e.textContent="Login"}catch(t){console.error("Login error:",t),l("Login failed: "+t.message,"error"),e.disabled=!1,e.textContent="Login"}});function l(o,e="info"){const t=document.getElementById("toast");if(!t)return;const n=e==="error"?'<i class="fas fa-times"></i>':'<i class="fas fa-info-circle"></i>';t.innerHTML=`
    <span class="toast-icon">${n}</span>
    <span class="toast-body">
      <span class="toast-title">${e==="error"?"Login Failed":"Notice"}</span>
      <span>${o}</span>
    </span>
  `,t.className="toast "+e+" show",setTimeout(()=>{t.classList.remove("show")},4500)}
